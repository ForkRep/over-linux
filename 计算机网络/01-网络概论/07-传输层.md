## 一 传输层概念

传输层协议用于让运行在不同主机上的应用进程之间实现逻辑通信。这里需要区分的是：网络层实现的是主机之间的逻辑通信，传输层实现的是逐渐之间进程的逻辑通信。    

协议的实现位于端系统，而不是路由器。应用的报文会被划分为较小的块，每一块都加上一个传输层首部，即成为传输层的报文段。这个报文段到达网络层时，网络层只是将其封装为数据报（网络层分组），而不会检查封装在该数据报中传输层报文段的字段。  

## 二 传输层协议

### 2.1 传输层协议要求

传输层协议往往需要从四个方面来分类：
- **可靠数据传输**（reliable data transfer）：分组在网络中会因为比特损坏、路由缓存溢出等问题被丢弃，传输层协议需要额外做一些工作确保应用程序的一段发送的数据正确、完整的交付给另一端。
  - 类似多媒体如视频允许出现小干扰，不会产生致命错误，这是能被**容忍丢失的应用**（loss-tolerant application）
- **吞吐量**：即发送进程能够向接收进程交付比特的速率。具有吞吐量要求的应用程序被称为**带宽敏感应用**（bandwidth-sensitive application），也有一些应用如：电子邮件等可以依据情况或多、或少的利用吞吐量，这是**弹性应用**(elastic application)
- **定时**：类似吞吐量的保证，如：发送方注入进套接字中的每个比特到达接收方套接字不迟于100ms。
- **安全**：如加密传输、解密接收

### 2.2 常见传输层协议

传输协议有：TCP、UDP。   

TCP：
- 面向连接：应用层数据报文在传输前，TCP协议要求客户端与服务端之间先互相交换传输层控制信息，以为即将到来的数据报文做准备，这个阶段称为握手。握手完成后，一个**TCP连接**（TCP connection）就在两个进程的套接字之间建立了，这个连接是**全双工**的，即双方的进程可以在此连接上互相进行报文收发。
- 可靠传输：通信进程能够依靠TCP，无差错、适当顺序交付所有发送的数据，保证没有字节的丢失和冗余。  
- 拥塞控制机制：该机制不会为通信进程带来好处，但是在出现网络拥堵时，该机制会一直发送进程，以让其他连接公平共享带宽。   

UDP：
- 无连接轻量级运输协议，仅能提供最小服务。无连接意味着没有握手过程，也不能保证接收进程接收的报文是有序的。
- UDP也没有拥塞控制机制。 


TCP和UPD没提供的保证：
- 没有提供加密机制，但是**安全套接字层（Secure Sockets Layer ，SSL）** 为TCP增强了安全性，但是SSL不能视为是和TCP、UDP一样的协议（只是一个增强组件）！  
- 没有吞吐量、定时保证

注意：
```
网络层的IP协议是不可靠服务（unreliable service），IP服务模型只是尽力而为交付任务（best-effort delivery service），即尽力在通信主机之间交付报文段，但是不做任何确保。  

传输层的UPD和TCP可以对报文段首部进行完整性检查。

进程到进程的数据交付和差错检查是最低限度的传输层服务，也是UDP能提供的仅有的两种服务，与IP一样，UDP也是不可靠的，不能保证一个进程所发送的数据能够完整无缺或者全部到达目的进程。
```

## 三 多路复用与多路分解

假设在接收端，用户运行了四个进程：一个Web页面（HTTP进程）、一个文件服务器客户端（FTP进程）、两个Telnet会话，传输层的数据到达接收端时，并不会直接由对应进程接收，而是该进程的套接字（socket）来接收，每个套接字都有唯一的标识符（端口）来标识。    

> **多路复用**(mutiplexing)：在源主机上从不同套接字中收集数据块，并为每个数据块封装上首部信息生成报文段，然后将报文段传递到网络层

> **多路分解**(demultiplexing)：在接收端，将传输层报文段中的数据交付到正确的套接字过程，称多路分解



## 四 TCP


## 五 UDP



